<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>月間カレンダー</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link
      rel="stylesheet"
      th:href="@{/css/common.css}"
      href="/css/common.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesk:wght@500;600&family=Noto+Sans+JP:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Noto Sans JP", "Hiragino Kaku Gothic ProN", system-ui,
          -apple-system, BlinkMacSystemFont, sans-serif;
        background: radial-gradient(
          circle at top,
          #fff3d7,
          #fde0c8 45%,
          #f8cdc0
        );
        color: #1f2937;
      }

      h1,
      h2 {
        font-family: "Bricolage Grotesk", "Noto Sans JP", sans-serif;
        font-weight: 600;
        letter-spacing: 0.04em;
      }

      .calendar-card {
        background: rgba(255, 255, 255, 0.92);
        border-radius: 1.5rem;
        border: 1px solid rgba(15, 23, 42, 0.06);
        box-shadow: 0 15px 40px rgba(255, 123, 0, 0.12);
        transition: transform 120ms ease, box-shadow 120ms ease;
      }

      .calendar-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 22px 45px rgba(255, 123, 0, 0.16);
      }

      .weekday-pill {
        font-family: "Bricolage Grotesk", "Noto Sans JP", sans-serif;
      }
    </style>
  </head>
  <body class="min-h-screen py-10">
    <div class="max-w-6xl mx-auto px-4 space-y-8">
      <header
        class="flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between"
      >
        <div>
          <p class="text-sm text-amber-700 tracking-[0.3em] uppercase">
            Flow Calendar
          </p>
          <h1 class="text-4xl text-slate-900" th:text="${monthLabel}"></h1>
          <p class="text-sm text-slate-600 mt-2">
            今月の毎日をカレンダーで俯瞰し、収入と支出の動きをざっと確認できます。
          </p>
        </div>
        <div class="flex flex-wrap gap-3">
          <a
            href="/"
            class="px-4 py-2 rounded-full border border-slate-300 text-sm text-slate-700 hover:bg-white/80"
            >収支一覧</a
          >
          <a
            href="/overview"
            class="px-4 py-2 rounded-full bg-slate-900 text-white text-sm shadow-lg shadow-slate-700/30"
            >カテゴリ内訳</a
          >
          <a
            href="/"
            class="px-4 py-2 rounded-full bg-white text-slate-900 text-sm border border-white/60 shadow"
            >ホーム</a
          >
        </div>
      </header>

      <section class="grid gap-4 md:grid-cols-3">
        <article class="calendar-card p-6">
          <p class="text-xs uppercase tracking-[0.4em] text-amber-600">
            Income
          </p>
          <h2 class="text-3xl text-emerald-600 mt-2">
            <span
              th:text="${#numbers.formatDecimal(monthIncomeTotal, 1, 'COMMA', 0, 'POINT')}"
            ></span>
          </h2>
          <p class="text-xs text-slate-500 mt-1">今月の合計収入</p>
        </article>
        <article class="calendar-card p-6">
          <p class="text-xs uppercase tracking-[0.4em] text-rose-500">
            Expense
          </p>
          <h2 class="text-3xl text-rose-500 mt-2">
            <span
              th:text="${#numbers.formatDecimal(monthExpenseTotal, 1, 'COMMA', 0, 'POINT')}"
            ></span>
          </h2>
          <p class="text-xs text-slate-500 mt-1">今月の合計支出</p>
        </article>
        <article class="calendar-card p-6">
          <p class="text-xs uppercase tracking-[0.4em] text-slate-500">Net</p>
          <h2
            class="text-3xl mt-2"
            th:classappend="${monthNet >= 0} ? 'text-emerald-600' : 'text-rose-500'"
          >
            <span
              th:text="${#numbers.formatDecimal(monthNet, 1, 'COMMA', 0, 'POINT')}"
            ></span>
          </h2>
          <p class="text-xs text-slate-500 mt-1">収入 − 支出</p>
        </article>
      </section>

      <section class="space-y-4">
        <div class="grid grid-cols-7 text-center text-xs text-slate-500">
          <p
            class="weekday-pill tracking-[0.2em]"
            th:each="weekday : ${weekdays}"
            th:text="${weekday}"
          ></p>
        </div>

        <div class="space-y-4">
          <div class="grid grid-cols-7 gap-4" th:each="week : ${weeks}">
            <article
              class="calendar-card p-4 flex flex-col gap-3"
              th:each="day : ${week}"
              th:classappend="${(day.inCurrentMonth() ? '' : 'opacity-50 ') + (day.date().equals(today) ? ' ring-2 ring-amber-400 shadow-xl shadow-amber-200/30' : '')}"
            >
              <div class="flex items-center justify-between">
                <div>
                  <p
                    class="text-xs uppercase tracking-[0.4em] text-slate-400"
                    th:text="${day.weekdayLabel()}"
                  ></p>
                  <p
                    class="text-3xl font-semibold text-slate-900"
                    th:text="${day.dayOfMonth()}"
                  ></p>
                </div>
                <div class="text-right text-xs">
                  <p class="text-emerald-500" th:if="${day.hasIncome()}">
                    +
                    <span
                      th:text="${#numbers.formatDecimal(day.incomeTotal(), 1, 'COMMA', 0, 'POINT')}"
                    ></span>
                  </p>
                  <p class="text-rose-500" th:if="${day.hasExpense()}">
                    -
                    <span
                      th:text="${#numbers.formatDecimal(day.expenseTotal(), 1, 'COMMA', 0, 'POINT')}"
                    ></span>
                  </p>
                  <p
                    class="font-semibold"
                    th:classappend="${day.netTotal() >= 0} ? 'text-emerald-600' : 'text-rose-500'"
                  >
                    <span th:text="${day.netTotal() >= 0 ? '+' : ''}"></span>
                    <span
                      th:text="${#numbers.formatDecimal(day.netTotal(), 1, 'COMMA', 0, 'POINT')}"
                    ></span>
                  </p>
                </div>
              </div>

              <div
                class="text-[11px] uppercase tracking-[0.3em] text-orange-500"
                th:if="${day.date().equals(today)}"
              >
                Today
              </div>
            </article>
          </div>
        </div>
      </section>
    </div>
  </body>
</html>
